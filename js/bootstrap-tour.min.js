(function(){(function(e,t){var n,r;r=t.document;n=function(){function n(t){this._options=e.extend({name:"tour",labels:{end:"End tour",next:"Next &raquo;",prev:"&laquo; Prev"},template:"<div class='popover tour'>            <div class='arrow'></div>            <h3 class='popover-title'></h3>            <div class='popover-content'></div>          </div>",container:"body",keyboard:!0,useLocalStorage:!1,debug:!1,backdrop:!1,afterSetState:function(e,t){},afterGetState:function(e,t){},afterRemoveState:function(e){},onStart:function(e){},onEnd:function(e){},onShow:function(e){},onShown:function(e){},onHide:function(e){},onHidden:function(e){}},t);this._steps=[];this.setCurrentStep();this.backdrop={overlay:null,step:null,background:null}}n.prototype.setState=function(n,r){n=""+this._options.name+"_"+n;this._options.useLocalStorage?t.localStorage.setItem(n,r):e.cookie(n,r,{expires:36500,path:"/"});return this._options.afterSetState(n,r)};n.prototype.removeState=function(n){n=""+this._options.name+"_"+n;this._options.useLocalStorage?t.localStorage.removeItem(n):e.removeCookie(n,{path:"/"});return this._options.afterRemoveState(n)};n.prototype.getState=function(n){var r;this._options.useLocalStorage?r=t.localStorage.getItem(""+this._options.name+"_"+n):r=e.cookie(""+this._options.name+"_"+n);if(r===void 0||r==="null")r=null;this._options.afterGetState(n,r);return r};n.prototype.addStep=function(e){return this._steps.push(e)};n.prototype.getStep=function(t){if(this._steps[t]!=null)return e.extend({path:"",placement:"right",title:"",content:"",id:"step-"+t,next:t===this._steps.length-1?-1:t+1,prev:t-1,animation:!0,redirect:!0,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,template:this._options.template,container:this._options.container},this._steps[t])};n.prototype.start=function(t){var n,i=this;t==null&&(t=!1);if(this.ended()&&!t)return this._debug("Tour ended, start prevented.");e(r).off("click.bootstrap-tour",".popover .next").on("click.bootstrap-tour",".popover .next",function(e){e.preventDefault();return i.next()});e(r).off("click.bootstrap-tour",".popover .prev").on("click.bootstrap-tour",".popover .prev",function(e){e.preventDefault();return i.prev()});e(r).off("click.bootstrap-tour",".popover .end").on("click.bootstrap-tour",".popover .end",function(e){e.preventDefault();return i.end()});this._onresize(function(){return i.showStep(i._current)});this._setupKeyboardNavigation();n=this._makePromise(this._options.onStart!=null?this._options.onStart(this):void 0);return this._callOnPromiseDone(n,this.showStep,this._current)};n.prototype.next=function(){var e;e=this.hideStep(this._current);return this._callOnPromiseDone(e,this.showNextStep)};n.prototype.prev=function(){var e;e=this.hideStep(this._current);return this._callOnPromiseDone(e,this.showPrevStep)};n.prototype.end=function(){var n,i,s=this;n=function(n){e(r).off("click.bootstrap-tour");e(r).off("keyup.bootstrap-tour");e(t).off("resize.bootstrap-tour");s.setState("end","yes");s._hideBackdrop();if(s._options.onEnd!=null)return s._options.onEnd(s)};i=this.hideStep(this._current);return this._callOnPromiseDone(i,n)};n.prototype.ended=function(){return!!this.getState("end")};n.prototype.restart=function(){this.removeState("current_step");this.removeState("end");this.setCurrentStep(0);return this.start()};n.prototype.hideStep=function(t){var n,r,i,s=this;i=this.getStep(t);r=this._makePromise(i.onHide!=null?i.onHide(this):void 0);n=function(t){var n;n=e(i.element).popover("hide");i.reflex&&n.css("cursor","").off("click.boostrap-tour");i.backdrop&&s._hideBackdrop();if(i.onHidden!=null)return i.onHidden(s)};this._callOnPromiseDone(r,n);return r};n.prototype.showStep=function(t){var n,i,s,o=this;s=this.getStep(t);if(!s)return;n=this._makePromise(s.onShow!=null?s.onShow(this):void 0);i=function(n){var i,u;o.setCurrentStep(t);u=typeof s.path=="function"?s.path.call():s.path;i=[r.location.pathname,r.location.hash].join("");if(o._isRedirect(u,i)){o._redirect(s,u);return}if(s.element==null||e(s.element).length===0||!e(s.element).is(":visible")){o._debug("Skip the step "+(o._current+1)+". The element does not exist or is not visible.");o.showNextStep();return}s.backdrop&&o._showBackdrop(s.element);o._showPopover(s,t);s.onShown!=null&&s.onShown(o);return o._debug("Step "+(o._current+1)+" of "+o._steps.length)};return this._callOnPromiseDone(n,i)};n.prototype.setCurrentStep=function(e){if(e!=null){this._current=e;return this.setState("current_step",e)}this._current=this.getState("current_step");return this._current===null?this._current=0:this._current=parseInt(this._current)};n.prototype.showNextStep=function(){var e;e=this.getStep(this._current);return this.showStep(e.next)};n.prototype.showPrevStep=function(){var e;e=this.getStep(this._current);return this.showStep(e.prev)};n.prototype._debug=function(e){if(this._options.debug)return t.console.log("Bootstrap Tour '"+this._options.name+"' | "+e)};n.prototype._isRedirect=function(e,t){return e!=null&&e!==""&&e.replace(/\?.*$/,"").replace(/\/?$/,"")!==t.replace(/\/?$/,"")};n.prototype._redirect=function(e,t){if(typeof e.redirect=="function")return e.redirect.call(this,t);if(e.redirect===!0){this._debug("Redirect to "+t);return r.location.href=t}};n.prototype._renderNavigation=function(e,t){var n,r;r=[];e.prev>=0&&r.push("<a href='#"+e.prev+"' class='prev'>"+t.labels.prev+"</a>");e.next>=0&&r.push("<a href='#"+e.next+"' class='next'>"+t.labels.next+"</a>");n=r.join(" | ");return n+="<a href='#' class='pull-right end'>"+t.labels.end+"</a>"};n.prototype._showPopover=function(t,n){var r,i,s,o=this;i=""+t.content+"<br /><p>";s=e.extend({},this._options);t.options&&e.extend(s,t.options);t.reflex&&e(t.element).css("cursor","pointer").on("click.bootstrap-tour",function(e){return o.next()});i+=this._renderNavigation(t,s);e(t.element).popover("destroy").popover({placement:t.placement,trigger:"manual",title:t.title,content:i,html:!0,animation:t.animation,container:t.container,template:t.template}).popover("show");r=e(t.element).data("popover").tip();r.attr("id",t.id);this._reposition(r,t);return this._scrollIntoView(r)};n.prototype._reposition=function(t,n){var i,s,o,u,a,f,l;a=t[0].offsetWidth;u=t[0].offsetHeight;l=t.offset();o=l.left;f=l.top;i=e(r).outerHeight()-l.top-e(t).outerHeight();i<0&&(l.top=l.top+i);s=e("html").outerWidth()-l.left-e(t).outerWidth();s<0&&(l.left=l.left+s);l.top<0&&(l.top=0);l.left<0&&(l.left=0);t.offset(l);if(n.placement==="bottom"||n.placement==="top"){if(o!==l.left)return this._replaceArrow(t,(l.left-o)*2,a,"left")}else if(f!==l.top)return this._replaceArrow(t,(l.top-f)*2,u,"top")};n.prototype._replaceArrow=function(e,t,n,r){return e.find(".arrow").css(r,t?50*(1-t/n)+"%":"")};n.prototype._scrollIntoView=function(n){var r;r=n.get(0).getBoundingClientRect();if(!(r.top>=0&&r.bottom<e(t).height()&&r.left>=0&&r.right<e(t).width()))return n.get(0).scrollIntoView(!0)};n.prototype._onresize=function(n,r){return e(t).on("resize.bootstrap-tour",function(){clearTimeout(r);return r=setTimeout(n,100)})};n.prototype._setupKeyboardNavigation=function(){var t=this;if(this._options.keyboard)return e(r).on("keyup.bootstrap-tour",function(e){if(!e.which)return;switch(e.which){case 39:e.preventDefault();return t._current<t._steps.length-1?t.next():t.end();case 37:e.preventDefault();if(t._current>0)return t.prev();break;case 27:e.preventDefault();return t.end()}})};n.prototype._makePromise=function(t){return t&&e.isFunction(t.then)?t:null};n.prototype._callOnPromiseDone=function(e,t,n){var r=this;return e?e.then(function(e){return t.call(r,n)}):t.call(this,n)};n.prototype._showBackdrop=function(e){if(this.backdrop.overlay!==null)return;this._showOverlay();return this._showOverlayElement(e)};n.prototype._hideBackdrop=function(){if(this.backdrop.overlay===null)return;this._hideOverlayElement();return this._hideOverlay()};n.prototype._showOverlay=function(){this.backdrop=e("<div/>");this.backdrop.addClass("tour-backdrop");this.backdrop.height(e(r).innerHeight());return e("body").append(this.backdrop)};n.prototype._hideOverlay=function(){this.backdrop.remove();return this.backdrop.overlay=null};n.prototype._showOverlayElement=function(t){var n,r,i,s;s=e(t);i=5;r=s.offset();r.top=r.top-i;r.left=r.left-i;n=e("<div/>");n.width(s.innerWidth()+i).height(s.innerHeight()+i).addClass("tour-step-background").offset(r);s.addClass("tour-step-backdrop");e("body").append(n);this.backdrop.step=s;return this.backdrop.background=n};n.prototype._hideOverlayElement=function(){this.backdrop.step.removeClass("tour-step-backdrop");this.backdrop.background.remove();this.backdrop.step=null;return this.backdrop.background=null};return n}();return t.Tour=n})(jQuery,window)}).call(this);